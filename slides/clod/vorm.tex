\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{PIL} \PY{k+kn}{import} \PY{n}{Image}
\PY{k+kn}{from} \PY{n+nn}{glob} \PY{k+kn}{import} \PY{n}{glob}

\PY{n}{target} \PY{o}{=} \PY{n}{phash}\PY{p}{(}\PY{n}{Image}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{l+s}{'}\PY{l+s}{target.png}\PY{l+s}{'}\PY{p}{)}\PY{p}{)}

\PY{n}{candidates} \PY{o}{=} \PY{n}{glob}\PY{p}{(}\PY{l+s}{'}\PY{l+s}{../images/[0-9][0-9].*}\PY{l+s}{'}\PY{p}{)}
\PY{n}{candidates} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{(}\PY{n}{f}\PY{p}{,} \PY{n}{phash}\PY{p}{(}\PY{n}{Image}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{n}{f}\PY{p}{)}\PY{p}{)}\PY{p}{)} \PYZbs{}
                    \PY{k}{for} \PY{n}{f} \PY{o+ow}{in} \PY{n}{candidates}\PY{p}{)}

\PY{n}{diffs} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{p}{)}
\PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{candidates}\PY{p}{:}
    \PY{n}{diffs}\PY{p}{[}\PY{n}{c}\PY{p}{]} \PY{o}{=} \PY{n}{diff}\PY{p}{(}\PY{n}{target}\PY{p}{,} \PY{n}{candidates}\PY{p}{[}\PY{n}{c}\PY{p}{]}\PY{p}{)}

\PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{diffs}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{n}{diffs}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}getitem\PYZus{}\PYZus{}}\PY{p}{)}\PY{p}{:}
    \PY{k}{print} \PY{n}{c}\PY{p}{,} \PY{n}{diffs}\PY{p}{[}\PY{n}{c}\PY{p}{]}
\end{Verbatim}
